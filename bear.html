<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polar Bear's Marshmallow Challenge</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Fredoka One', cursive; 
            background: #e3f2fd; color: #2c3e50; text-align: center; padding: 20px; 
        }
        .container { 
            background: white; border-radius: 40px; padding: 30px; 
            max-width: 850px; margin: auto; border: 8px solid #3498db; 
            box-shadow: 0 10px 0 #2980b9;
        }
        #bear-img { width: 160px; }
        
        /* The Progress Area */
        .reward-zone { 
            background: #fff3e0; padding: 15px; border-radius: 20px; 
            margin: 20px 0; border: 3px dashed #ff9800; display: flex; 
            justify-content: center; align-items: center; gap: 10px;
        }
        .marshmallow { font-size: 2rem; opacity: 0.3; transition: 0.5s; }
        .marshmallow.earned { opacity: 1; transform: scale(1.2); }

        .scenario-box { 
            background: #f8f9fa; padding: 25px; border-radius: 20px; 
            margin: 20px 0; font-size: 1.4rem; border-left: 10px solid #3498db;
        }
        
        /* Identical Choice Grid - No cheating! */
        .choice-grid { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; 
        }
        .choice-btn {
            padding: 20px; border-radius: 20px; border: 3px solid #3498db;
            background: #fff; color: #2c3e50; cursor: pointer;
            font-size: 1.1rem; font-weight: bold; transition: 0.2s;
            box-shadow: 0 6px #3498db; display: flex; align-items: center; justify-content: center;
        }
        .choice-btn:hover { background: #e1f5fe; transform: translateY(-2px); }
        .choice-btn:active { transform: translateY(4px); box-shadow: none; }

        .back-btn { margin-top: 30px; display: inline-block; color: #3498db; text-decoration: none; }
    </style>
</head>
<body>

<div class="container animate__animated animate__fadeIn">
    <img src="polar_bear.jpg" id="bear-img" alt="Polar Bear">
    <h1 style="color: #2980b9;">Polar Bear's Long-Run Lab</h1>

    <div class="reward-zone">
        <span>Cocoa Status:</span>
        <span id="m1" class="marshmallow">‚òÅÔ∏è</span>
        <span id="m2" class="marshmallow">‚òÅÔ∏è</span>
        <span id="m3" class="marshmallow">‚òÅÔ∏è</span>
        <span id="m4" class="marshmallow">‚òÅÔ∏è</span>
        <span id="m5" class="marshmallow">‚òÅÔ∏è</span>
    </div>

    <div class="scenario-box" id="scenario-text">Loading situation...</div>

    <div class="choice-grid" id="choices">
        </div>
</div>

<a href="index.html" class="back-btn">‚¨Ö Back to Map</a>

<script>
    let currentStep = 0;
    let earnedCount = 0;

    const gameData = [
        {
            scenario: "Polar Bear is building a Lego ice castle, but he can't find the very last piece. He feels his body getting tight and itchy with frustration.",
            options: [
                { text: "Dump the whole box on the floor to find it faster.", type: "impulse", feedback: "Now you have 500 pieces to look through instead of 50. You just made the job much harder!" },
                { text: "Kick the castle and say 'I didn't even want to build this anyway!'", type: "impulse", feedback: "That's a 'False Thought.' You did want to build it, and now it's broken. Your morning is ruined." },
                { text: "Take 3 deep 'North Pole' breaths and look under the rug.", type: "wise", feedback: "Found it! Staying calm kept your eyes sharp. You finished the castle!" },
                { text: "Ask someone to help you look for 2 minutes.", type: "wise", feedback: "Great teamwork! Two sets of eyes found the piece in 10 seconds flat." }
            ]
        },
        {
            scenario: "Another bear tells a joke that makes everyone laugh, but Polar Bear doesn't think it's funny. He feels a 'Spiky' feeling in his chest.",
            options: [
                { text: "Tell the other bear his joke was 'babyish' and stupid.", type: "impulse", feedback: "Ouch. That made the other bear sad and now everyone thinks you're a grouch. Not a win." },
                { text: "Just keep a quiet face and wait for the next game.", type: "wise", feedback: "Perfect. You don't have to laugh at everything, but being kind keeps the peace." },
                { text: "Start shouting a louder joke so people listen to you instead.", type: "impulse", feedback: "Now it's just a shouting match. Everyone is annoyed by the noise." },
                { text: "Walk to the water hole to get a drink and reset your spiky feeling.", type: "wise", feedback: "Excellent self-regulation. You handled that 'Spiky' feeling like a pro." }
            ]
        },
        {
            scenario: "Polar Bear's tablet battery dies right in the middle of his favorite game. He wants to throw it.",
            options: [
                { text: "Plug it in and go find a book to read while it charges.", type: "wise", feedback: "Smart! In 20 minutes, you'll have battery AND you got to read. Double win." },
                { text: "Scream 'THIS ALWAYS HAPPENS TO ME!'", type: "impulse", feedback: "Does it always happen? Or did you just forget to charge it? Screaming won't fill the battery." },
                { text: "Wait patiently by the charger and stare at the red light.", type: "wise", feedback: "It takes self-control to wait. You're training your brain to handle 'The Boring Middles'." },
                { text: "Try to turn it back on 50 times in a row.", type: "impulse", feedback: "That actually drains the tiny bit of power left even faster. You're working against yourself!" }
            ]
        }
    ];

    function loadGame() {
        if (currentStep >= gameData.length) {
            winGame();
            return;
        }

        const data = gameData[currentStep];
        document.getElementById('scenario-text').innerHTML = data.scenario;
        const choiceContainer = document.getElementById('choices');
        choiceContainer.innerHTML = "";

        // Shuffle options so the 'Wise' one isn't always in the same spot
        const shuffled = data.options.sort(() => Math.random() - 0.5);

        shuffled.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = `choice-btn`;
            btn.innerHTML = opt.text;
            btn.onclick = () => handleChoice(opt);
            choiceContainer.appendChild(btn);
        });
    }

    function handleChoice(opt) {
        if (opt.type === "wise") {
            earnedCount++;
            document.getElementById(`m${earnedCount}`).classList.add('earned');
            Swal.fire({
                title: "Wise Move! ‚òÅÔ∏è",
                text: opt.feedback + " You earned a marshmallow!",
                icon: "success",
                confirmButtonColor: "#3498db"
            }).then(() => {
                currentStep++;
                loadGame();
            });
        } else {
            Swal.fire({
                title: "Impulse Trap! ü™§",
                text: opt.feedback,
                icon: "error",
                confirmButtonText: "Think it through again",
                confirmButtonColor: "#e74c3c"
            });
        }
    }

    function winGame() {
        Swal.fire({
            title: "Cocoa Time! ‚òï",
            text: "You collected the marshmallows and mastered the Long-Run Lab!",
            imageUrl: 'https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNHJqZ3R6Z3R6Z3R6Z3R6Z3R6Z3R6Z3R6Z3R6Z3R6Z3R6JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1n/3o7TKVUn7iM8FMEU24/giphy.gif',
            imageWidth: 300,
            confirmButtonText: "Return to Map"
        }).then(() => {
            window.location.href = "index.html";
        });
    }

    loadGame();
</script>
</body>
</html>
